\documentclass[wes, manuscript]{copernicus}

%% \usepackage commands included in the copernicus.cls:
%\usepackage[german, english]{babel}
%\usepackage{tabularx}
%\usepackage{cancel}
%\usepackage{multirow}
%\usepackage{supertabular}
%\usepackage{algorithmic}
%\usepackage{algorithm}
%\usepackage{amsthm}
%\usepackage{float}
%\usepackage{subfig}
%\usepackage{rotating}


\usepackage{tabularx}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{amsmath}
%\usepackage[short]{optidef}
\usepackage{xcolor}
\usepackage{amsfonts}

% Colors
%---------------------------------------------------------------------------------
\definecolor{C1}{RGB}{31,119,180}
\definecolor{C2}{RGB}{255,127,14}
\definecolor{C3}{RGB}{44,160,44}
\definecolor{C4}{RGB}{214,39,40}

% Some  auxiliary commands for ease of mathematics notations
%---------------------------------------------------------------------------------
% Derivatives and differentials
\newcommand{\ds}{~\text{d}\boldsymbol{s}}
\newcommand{\dzeta}{~\text{d}\boldsymbol{\zeta}}
\newcommand{\pder}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\dx}{\text{d}\boldsymbol{x}}
\newcommand{\dt}{\text{d}t}
\newcommand{\ddt}[1]{\frac{\text{d} #1}{\text{d} t}}
% Integrals
\newcommand{\stint}{\int_{0}^{T} \int_{\Omega}}
\newcommand{\sint}{\int_{\Omega}}
\newcommand{\Tint}{\int_{0}^{T}}
\newcommand{\tint}{\int_{0}^{t}}
% Filtered variables
\newcommand{\utilde}{\widetilde{\bs{u}}}
\newcommand{\ptilde}{\widetilde{p}}
\newcommand{\ctnhat}[1]{\widehat{C}_{T,#1}'}
\newcommand{\ctihat}{\widehat{C}_{T,i}'}
\newcommand{\cthat}{\widehat{C}_T'}
% Other symbols
\newcommand{\ctmax}{C_{T,\text{max}}'}
\newcommand{\cti}{C_{T,i}'}
\newcommand{\ctn}[1]{C_{T,#1}'}
\newcommand{\R}{\mathscr{R}}
\newcommand{\J}{\mathscr{J}}
\newcommand{\Jtilde}{\tilde{\mathscr{J}}}
\newcommand{\Jgrad}{\nabla \Jtilde}
\newcommand{\Lagr}{\mathscr{L}}
\newcommand{\eperp}{\bs{e}_\perp}
\newcommand{\eperpi}{\bs{e}_{\perp,i}}
\newcommand{\etransi}{\bs{e}_{\parallel,i}}
\newcommand{\ex}{\bs{e}_x}
\newcommand{\ey}{\bs{e}_y}
\newcommand{\ez}{\bs{e}_z}
\newcommand{\eperpn}[1]{\bs{e}_{\perp,#1}}
\newcommand{\vi}{\frac{1}{A_i} \sint \R_i (\bs{s})~\utilde \cdot \eperpi \ds}
% Operators
\newcommand{\innerproduct}[2]{\bigg( #1, #2 \bigg)}
\newcommand{\innerproductsmall}[2]{\big( #1, #2 \big)}
\newcommand{\sumturbines}{\sum_{i=1}^{N_t}}
\newcommand{\diracdelta}{{\delta}}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\red}[1]{{\color{red} #1}}





\begin{document}

\title{Towards practical dynamic induction control of wind farms: analysis of optimally controlled wind-farm boundary layers and sinusoidal induction control of first-row turbines}
\runningtitle{Towards practical dynamic induction control of wind farms}

\Author[]{Wim}{Munters}
\Author[]{Johan}{Meyers}
\affil[]{Department of Mechanical Engineering, KU Leuven, Celestijnenlaan 300A, 3001 Leuven, Belgium}
\runningauthor{Munters and Meyers}
\correspondence{wim.munters@kuleuven.be}



\received{}
\pubdiscuss{} %% only important for two-stage journals
\revised{}
\accepted{}
\published{}

\firstpage{1}
\maketitle

\begin{abstract}
	Wake interactions between wind turbines in wind farms lead to reduced energy extraction in downstream rows. In recent work, optimization and large-eddy simulation were combined with optimal dynamic induction control of wind farms to study the mitigation of these effects, showing potential power gains up to 20\% (Munters \& Meyers 2017 \emph{Phil Trans R Soc A} \textbf{375}, 20160100, doi:10.1098/rsta.2016.0100). However, the computational cost associated with the optimal control simulations impedes practical implementation of this approach. Furthermore, the resulting control signals optimally react to the specific instantaneous turbulent flow realizations in the simulations, so that they cannot be simply be used in general. The current work focuses on the detailed analysis of the optimization results of Munters \& Meyers, with the aim to identify simplified control strategies that mimic the optimal control results and can be used in practice. The analysis shows that wind-farm controls are optimized in a parabolic manner with little upstream propagation of information. Moreover, turbines can be classified into first-row, intermediate-row, and last-row turbines based on their optimal control dynamics. At the moment, the control mechanisms for intermediate-row turbines remain unclear, but for first-row turbines we find that the optimal controls increase wake mixing by periodic shedding of vortex rings. This behavior can be mimicked with a simple sinusoidal thrust control strategy for first-row turbines, resulting in robust power gains for turbines in the entrance region of the farm.
\end{abstract}


\copyrightstatement{TEXT}


\introduction  %% \introduction[modified heading if necessary]
Wake interactions between turbines within a wind farm cause reduced power extraction and increased turbine loading in downstream rows. The current control paradigm in such farms optimizes performance at the wind-turbine level and does not account for these interactions, resulting in sub-optimal wind-farm efficiency. In contrast, control strategies at the farm level allow to influence wake interaction and promise to improve overall wind-farm performance by improving wind conditions for downstream turbines. This can be achieved by redirecting propagating wakes (yaw control, see e.g. \citealp{fleming2014evaluating, gebraad2016wind, campagnolo2016wind}) or by affecting the induced wake velocity deficits (axial induction control, see e.g. \citealp{nilsson2015large, annoni2016analysis, bartl2016experimental}). A more exhaustive survey of wind-farm control in a broader context can be found in \cite{knudsen2015survey} and \cite{boersma2017tutorial}. 

In contrast to the studies cited above, that all focus on static setpoint optimization of wind farms, \cite{goit2015optimal} introduced a dynamic induction control approach based on large-eddy simulations (LES) and adjoint gradient optimization. In this study, individual turbines were used as dynamic flow actuators that influence the wind-farm boundary layer flow in such a way as to optimize aggregate wind-farm power extraction. The methodology was applied to the asymptotic case of a fully-developed `infinite' aligned wind farm, and power gains of about 16\% were quantified. Later, this approach was also used in induction control studies of wind farms with entrance effects in \cite{goit2016optimal} and, more recently, in \cite{munters2017optimal}, where similar gains in the order of 15\%--20\% were achieved. 
It is important to note that the computational cost of this LES-based dynamic induction control methodology is orders of magnitude too high for direct implementation. However, the methodology allows to assess the theoretical potential for wind-farm control, and an increased understanding of the flow physics of controlled wind farms can lead to simplified control strategies that can be applied in practice.  

Recently, the methodology of \cite{goit2015optimal} was generalized to include dynamic yaw control in \cite{munters2018dynamic}. In this study, induction control and yaw control were compared for a relatively small aligned wind farm, and yaw control was found to yield higher power gains for this setup. Furthermore, the high potential of combined induction and yaw control was quantified, and analysis of the yaw control signals allowed to identify practical simplified dynamic yaw control strategies. The search for similar practical control strategies for induction control has remained unsuccessful to date. 

The current paper presents efforts on understanding optimal control dynamics observed in the optimal induction control simulations by \cite{munters2017optimal} (further denoted as MM17). The outline of the paper is as follows: first, Section~\ref{sec:optimal_control_sims} discusses the numerical setup and optimal control simulations of MM17 that will be further analysed in the current paper. Section~\ref{sec:analysis_controls_analysis} presents an analysis of the control and thrust force dynamics, and performs some numerical experiments to elucidate characteristics of the optimal controls. It will be shown that the coherent behavior of turbines situated in the first row of the wind farm stands out from their downstream counterparts. Hereafter, Section~\ref{sec:analysis_flow_vis} identifies the shedding of vortex rings from the first row based on a flow visualization. Further, a simple sinusoidal thrust control approach is presented that successfully mimics this process with a robust increase in power extraction extraction in the second row. Next, Section~\ref{sec:analysis_intermediate} shortly discusses the behavior of the intermediate rows, i.e. turbines which have both upstream and downstream neighbors, for which similar simple control strategies remain elusive thus far. In conclusion, Section~\ref{sec:analysis_summ} summarizes the main findings of this paper.

\section{Description of optimal control simulations in MM17}\label{sec:optimal_control_sims}
The current section describes the optimal control simulations performed by MM17, the results of which are further analyzed in the current paper. First, the methodology is introduced. Then, the numerical setup is detailed. Afterwards, the optimization results on power extraction and time-averaged flow field features are discussed. 

\subsection{Control methodology}

A schematic overview of the wind-farm control methodology is shown in Figure \ref{fig:optimization_meth}. Figure \ref{fig:optimization_meth}a illustrates the control block diagram: an iterative optimization loop updates the wind-farm control vector $\bs{\varphi}(t)$ until a set of optimized controls $\bs{\varphi}^{\bullet}(t)$ is found. This optimization is based upon an unsteady turbulence-resolving LES wind-farm flow model, and sensitivities of the cost functional $\J$ (i.e. the total wind-farm power extraction) are calculated using an adjoint formulation of this flow model. In this way, a priori simplifications to the turbulent boundary layer and wake representation are avoided as much as possible, and the control signals are designed in a such a way that turbines actively tap into the dynamic of the turbulent flow. The optimization is performed using a receding-horizon control framework, as illustrated in Figure \ref{fig:optimization_meth}b. In this framework, wind-farm controls $\bs{\varphi}(t)$ are optimized for a finite time horizon $T$, involving a sequential set of LES and adjoint LES simulations. Upon convergence of the optimization, optimized control signals are applied in a flow advancement simulation for a time $T_A < T$, after which a new optimization window is initiated. 

\begin{figure}
	\includegraphics[width=\textwidth]{figure1.eps}
	\caption{Schematic overview of wind-farm optimal control methodology from MM17. \emph{a)} Control block diagram with adjoint gradient-based optimization and LES flow models illustrating data flow of (optimal) controls $\bs{\varphi}^{(\bullet)}$, system state $\bs{q}$, cost functional $\J$ and its gradient $\nabla \J$. \emph{b)} Receding horizon framework subdividing time into discrete flow advancement windows of length $T_A$ with prediction horizon $T$. Each arrow represents a forward or adjoint LES. Every window consists of an optimization stage (blue and red lines) follow by a flow advancement stage with optimal controls $\bs{\varphi}^{\bullet}$ (green lines).  \label{fig:optimization_meth}}
\end{figure}

Within each optimization window, the total wind-farm power is optimized by solving the following partial-differential-equation-constrained optimization problem: 
\begin{alignat}{4}
& \underset{\bs{\varphi}, \bs{q}}{\text{minimize}}  & \qquad  \J(\bs{\varphi}, \bs{q}) &= - \Tint \sum_{i=1}^{N_t} P_i ~\dt  & \label{eq:costfunction}\\
& \text{s.t.}                      			&         \frac{\partial \utilde}{\partial t} + \big(\utilde \cdot \nabla \big)~ \utilde &= - \nabla (\ptilde + \ptilde_\infty) / \rho - \nabla \cdot \boldsymbol{\tau}_{sgs} + \sum_{i=1}^{N_t} \bs{f}_i \qquad  & \text{in } \Omega \times (0,T], \label{eq:NSmomentum_constraint} \\
&                                                   &        \nabla \cdot \utilde&=0 									        & \text{in } \Omega \times (0,T], \label{eq:NScontinuity_constraint}\\
&                                                   &        \tau \ddt{\ctihat}&=\cti - \ctihat 								& i=1\dots N_t~\text{in } (0,T],  \label{eq:ctihat_constraint}\\
&                                                   &       0 \leq~ &\cti \leq C_{T,\text{max}}'				& i=1\dots N_t~\text{in } (0,T],  \label{eq:boxct_constraint}
\end{alignat}
The cost functional that is optimized in \eqref{eq:costfunction} is the total wind-farm energy extraction over time horizon $T$. The control variables are the time-dependent thrust coefficient setpoints $C_{T,i}'$ of every turbine $i$ ($=1 \dots N_t$), i.e. $\bs{\varphi} = [C_{T,1}'(t), \dots, C_{T,N_t}'(t) ]$, and the state variables are denoted as  $\bs{q}=[\utilde(\bs{x},t);~ \ptilde(\bs{x},t);~ \widehat{C}_{T,1}'(t), \dots, \widehat{C}_{T,N_t}'(t)]$, with $\utilde$ the filtered velocity, $\ptilde$ the filtered pressure, and $\widehat{C}_{T,i}'$ the (time-filtered) thrust coefficient for turbine $i$ (see below). 

The filtered Navier--Stokes momentum and continuity state equations in \eqref{eq:NSmomentum_constraint} - \eqref{eq:NScontinuity_constraint} are solved using an in-house LES solver (see, e.g. \citealp{calaf2010large, meyers2010large, goit2016optimal} for a detailed discussion of the solver). The time-filtering state equation in \eqref{eq:ctihat_constraint} applies a one-sided exponential time filter to the thrust coefficient setpoints $C_{T,i}'$ with a characteristic wind-turbine response timescale $\tau$ \citep{munters2016effect}. Finally, the box constraints in \eqref{eq:boxct_constraint} limit the variations in the turbine thrust coefficients to technically feasible values. 

The forces exerted by turbine $i$ on the boundary-layer flow are parametrized using a standard non-rotating actuator disk model as
%\begin{equation}
%$	\bs{f}_i(\bs{x},t) = - \frac{1}{2}~ \widehat{C}_{T,i}'(t)~ V_i(t)^2~ \R_i (\bs{x})~ \eperpi,$
$	\bs{f}_i(\bs{x},t) = - (1/2) \widehat{C}_{T,i}'(t) V_i(t)^2 \R_i (\bs{x}) \eperpi,$
%\end{equation}
where $\R_i$ is a smoothed representation of the geometric footprint of the turbine on the LES grid and $\eperpi$ is the rotor-perpendicular vector. Further, the disk-averaged velocity is defined as $V_i = (1/A_i) \sint \R_i(\bs{x}) \utilde \cdot \eperpi ~\dx$, with $A_i$ the rotor disk area. Mechanical power captured by the wind turbine is calculated as $P_i = (1/2) C_{P,i}'(t) V_i(t)^3 A_i$, with $C_{P,i}' = 0.9 C_{T,i}'$, resulting from a fit of LES results to momentum theory, eliminating the overprediction of wind-turbine power on typical wind-farm LES grid resolutions \citep{munters2017optimal}.  

\subsection{Case setup}
The wind farm considered in MM17 has an aligned pattern of 12 rows by 6 columns, with 6 rotor diameters spacing in axial and tranversal directions. The flow is simulated on a domain of $10 \times 3.6 \times 1$ km$^3$, discretized on a simulation grid of $384 \times 192 \times 144$ grid points. A snapshot of the streamwise velocity field is shown in Figure \ref{fig:flowfield_MM17}. The wind farm was controlled over a total of $N_A = 15$ time windows with a prediction horizon $T = 240 s$ and a flow advancement time of $T_A = T/2 = 120 s$, resulting in a total control time $T_{\rm tot} = N_A T_A = 30$ minutes. 

\begin{figure}
	\includegraphics[width=0.8\textwidth]{flowfield_MM17}
	\caption{Instantaneous streamwise velocity $\widetilde{u}_x$ for the $12 \times 6$ aligned wind farm considered in MM17. Black lines indicate wind-turbine locations. The black dashed line near the end of the domain indicates a buffer region used for imposition of inflow boundary conditions. Figure originally published in \cite{munters2017optimal} under a~CC-BY 4.0 license.\label{fig:flowfield_MM17}}
\end{figure}

A conventionally (greedily) controlled wind farm with steady $C_T' = 2$ (corresponding to the Betz limit in momentum theory) was defined as a reference case. Several different optimal control cases were defined, based on the wind-turbine response time $\tau = $0, 5, or 30 s (instantaneous, fast, or slow response, see Equation \ref{eq:ctihat_constraint}) and the maximal thrust coefficient $\ctmax = 2$ or 3 (underinductive or overinductive, see Equation \ref{eq:boxct_constraint}). Cases are denoted as C<X>t<Y>, where X and Y represent $\ctmax$ and $\tau$ respectively, e.g. C3t30  for the case with $\ctmax = 3$ and $\tau = 30$ s. 

\subsection{Simulation results}

Figure \ref{fig:power_MM17} illustrates the energy extraction of the optimally controlled wind farm cases, normalized by the greedy reference control case. Figure \ref{fig:power_MM17}a shows that the adjoint LES-based control approaches achieves energy gains ranging from a minor 2\% in the most restrictive C2t30 case to over 20\% in the C3t0 case. From Figure \ref{fig:power_MM17}b it can be seen that, for all cases except C3t30, power is curtailed in the first row to a limited degree, whereas the downstream rows compensate for this loss by extracting significantly more energy. Furthermore, not taking into account the first row, the last row achieves the highest energy extraction in every case, as it can act greedily without compromising power extraction in downstream neighbors. 

\begin{figure}
	\includegraphics[width=\textwidth]{power_MM17}
	\caption{Energy extraction $E_O$ of optimally controlled wind-farm cases from MM17, normalized by a greedy reference case $E_R$. \emph{a)} Total energy extraction. Error bars indicate confidence intervals of $\pm$ 2 standard deviations. \emph{b)} Energy extraction by row, normalized by first-row reference power. C3t0, red line; C3t5, yellow line; C3t30, blue line; C2t0, red dashed line; C2t5, yellow dashed line; C2t30, blue dashed line. Figure originally published in \cite{munters2017optimal} under a~CC-BY 4.0 license.\label{fig:power_MM17}}
\end{figure}

In the remainder of this section, time-averaged wind-farm flow properties will be investigated. Here and throughout the remainder of this paper, we focus on case C3t5, as it produces similar energy gains as the highest-yield case C3t0 (see Figure \ref{fig:power_MM17}a), but achieves this with smooth thrust coefficient signals. In the following discussion, the time averaging operation is denoted by an overline, and flow field variables are decomposed into mean and fluctuating components as $\widetilde{u} = \overline{\widetilde{u}} + \widetilde{u}' \equiv \widetilde{U} + \widetilde{u}'  $. Figure \ref{fig:flowfield_statistics} illustrates time-averaged flow field quantities of the reference case (left panels, a1 -- g1) and the differences between the optimized C3t5 case and the reference case (right panels, a2 -- g2). Simulation results are averaged over the different columns and are shown as either topviews at hub height (Figures \ref{fig:flowfield_statistics}b,f,g) or sideviews through a turbine column (Figures \ref{fig:flowfield_statistics}a,c,d,e). 

Figures \ref{fig:flowfield_statistics}a and \ref{fig:flowfield_statistics}b illustrate sideviews and topviews of the axial velocity throughout the wind farm. It can be seen that downstream turbines in the controlled case experience consistently higher incoming velocities, which explains the increased energy extraction discussed above. Furthermore, a larger drop in streamwise velocity over the turbine disk can be observed, most notably in the first-row turbines, indicating deeper wakes with enhanced recovery before hitting the next row of turbines. Furthermore, it can be observed that the axial velocity in the flow above and besides the wind-turbine column is reduced, indicating that the mean-flow kinetic energy is depleted in these regions, to the benefit of the flow passing through the wind turbines. 

Figures \ref{fig:flowfield_statistics}c shows sideviews of turbulence kinetic energy. The figure shows an increase in turbulence throughout the entire wind farm, spreading to the internal boundary layer above the turbines. Note specifically the sharp increase in turbulence in the core wake region behind the first-row turbine, for which an enhanced recovery was found as discussed above. 

Figure~\ref{fig:flowfield_statistics}d and \ref{fig:flowfield_statistics}e show sideviews through the rotor centerline of top-down turbulence and mean-flow transport of axial momemtum, i.e. $-\overline{\widetilde{u}_x' \widetilde{u}_z'}$ and $- \widetilde{U}_x \widetilde{U}_z$ respectively. It can be seen that, although mean-flow vertical transport is virtually unaffected, turbulence top-down transport of axial momentum is increased significantly in the upper part of the wakes, indicating increased turbulent mixing with the internal boundary layer above the wind-farm canopy. The effect is somewhat more pronounced in the wake behind the first row of turbines, for which also a slight increase in upwards transport of momentum can be observed in the lower part of the wake. 

Figure~\ref{fig:flowfield_statistics}f and \ref{fig:flowfield_statistics}g show planviews at hub height of transversal turbulence and mean-flow transport of axial momemtum, i.e. $\overline{\widetilde{u}_x' \widetilde{u}_y'}$ and $\widetilde{U}_x \widetilde{U}_y$ respectively. The sign convention is such that positive values correspond to transport in the positive $y$ direction in the figure. A slight increase in turbulent transversal transport towards the wake centerline can be observed behind every row. The mean-flow transversal momentum transport into the wake region is increased significantly behind the first two turbine rows. Downstream of these rows, the difference between these cases and the reference case is far less coherent. The latter can be explained by the fact that $\widetilde{U}_x$ in the intercolumn channels starts to deviate significantly from the reference case as shown in Figure~\ref{fig:flowfield_statistics}b. 

The analysis of flow features given above indicates that the optimal controls in case C3t5 influence the wind-farm flow field in such a way as to provide better flow conditions for downstream turbines. Increased axial velocities are observed for all downstream turbines, and enhanced momentum transport towards the turbine region is achieved. Furthermore, many of the observed flow features are most salient for the first row turbines. In the following section, the optimized thrust coefficients themselves will be investigated. It will be shown that, also from a controls perspective, first-row turbines stand out from their downstream counterparts.

\begin{figure}
	\includegraphics[width=\textwidth]{statfig_initial.eps}
	\caption{Time-averaged flow field quantities of simulation results from MM17. \emph{Left (1):} Time averages of reference simulations with $C_T' = 2$ for all turbines. \emph{Right (2):} Difference $\Delta$ between reference and optimal control (C3t5) simulation, defined as $\Delta = X_{\rm C3t5} - X_{\rm REF}$ for any variable $X$. \emph{a):} Axial velocity $U_x$ (planview at hub height). \emph{b):} Axial velocity $U_x$ (sideview through turbine column). \emph{c):} Turbulence kinetic energy $k = (1/2)(\overline{\widetilde{u}'_x \widetilde{u}'_x} + \overline{\widetilde{u}'_y \widetilde{u}'_y} + \overline{\widetilde{u}'_z \widetilde{u}'_z})$ (sideview). \emph{c):} Turbulence top-down transport $ - \overline{\widetilde{u}'_x\widetilde{u}'_z}$. \emph{c):} Mean-flow top-down transport $ - \widetilde{U}_x \widetilde{U}_z$ (sideview). \emph{c):} Turbulence horizontal transport $\overline{\widetilde{u}'_x \widetilde{u}'_y}$ (planview). \emph{c):} Mean-flow horizontal transport $\widetilde{U}_x \widetilde{U}_y$ (planview). Black lines indicate wind turbine locations. Simulation results are averaged over the six different wind turbine columns. \label{fig:flowfield_statistics}}
\end{figure}


\section{Thrust coefficient analysis and numerical experiments}\label{sec:analysis_controls_analysis}

The current section focuses on the optimal thrust coefficients generated by the optimal control simulations in MM17, and performs numerical experiments to uncover some of the characteristics of these control signals. 

First, the thrust coefficient signals themselves are analyzed in Section~\ref{sec:analysis_thrust}. Second, the optimized thrust coefficients are applied only to subsets of turbine rows in Section~\ref{sec:application_subset}. In this way, the interdependency of optimized thrust coefficients in different rows can be evaluated. Third, additional optimal control simulations, in which only one single active row is optimized, are discussed in Section~\ref{sec:optimization_single}. These optimizations provide an indication on how increased power potential is distributed among the rows, and allows to compare the resulting single-row optimized thrust coefficients with the fully cooperative coefficients from case MM17. Fourth, Section~\ref{sec:modified_thrust} evaluates the dependency of optimized thrust coefficients on the actual turbulent flow realization. Finally, Section~\ref{sec:analysis_discussion} discusses the main conclusions from the abovementioned sections, and summarizes the lessons learned.

\subsection{Analysis of thrust coefficient signals}\label{sec:analysis_thrust}

Figure~\ref{fig:controls} illustrates the time evolution of some of  the thrust coefficients $\cthat$ in the C3t5 case. The figure shows that, for all rows but the last one (i.e. R12), $\cthat$ varies significantly in time, and that the amplitudes and frequencies of these variations are somewhat higher in the upstream rows of the farm. In contrast, row 12 features only minor unsteadiness at lower frequencies, and has an increased mean value of $\cthat$. This relatively steady behavior of the last row can be explained by the fact that there are no further downstream turbines that can benefit from row 12 actively influencing local flow conditions, hence the row optimizes its own power only. The increase in mean $\cthat$ in row 12 can be explained based on Figure~\ref{fig:ct_sweep}, which shows the power extraction as a function of steady $\cthat$ for unwaked turbines, subject to identical turbulent inlet as in case C3t5. Although momentum theory predicts maximal power extraction for steady uniform inflow at $\cthat = 2$, the actual optimal steady value for the ADM at the current spatial resolution lies somewhat higher at $\cthat \approx 2.4$, for which power extraction is about 1.4\% higher than at $\cthat = 2$. This behavior is related to the overprediction in ADM power due to the diffuse turbine representation on typical simulation grids: the mass flow through the rotor disk at $\cthat > 2$ is slightly too high compared to momentum theory, resulting in a  shift of optimal $\cthat$ towards somewhat higher values. Although the linear fit $C_P' = a \cthat$ introduced in \cite{munters2017optimal}, Appendix~A eliminates the error in maximal power extraction, it does not correct the value of the optimal $\cthat$ (note that this could be achieved through a more complex relation between $C_P'$ and $\cthat$). Returning to the more complex thrust coefficients in the other rows it is worth noting that, based on the current dataset, no statistically significant correlations between thrust coefficients of different turbines could be found. Furthermore, attempts towards linking thrust coefficient dynamics to upstream flow measurements (e.g. velocities, shear or kinetic energy) through linear regression models and random forest regressors have been unsuccessful to date. 

\begin{figure}
	\includegraphics[width=0.8\textwidth]{controls.eps}
	\caption{Time evolution of the thrust coefficient $\cthat$ for a selection of optimally controlled turbines  of case C3t5. \emph{Left: } Total time horizon. \emph{Right: } Zoomed view, including setpoint $C_T'$ in gray. \label{fig:controls}}
\end{figure}

\begin{figure}
	\includegraphics[width=0.8\textwidth]{sweep_ct.eps}
	\caption{Normalized power extraction as a function of steady thrust coefficient $\cthat$ for wind turbines subject to the same freestream turbulent inflow as in case C3t5. Every dot corresponds to one LES.\label{fig:ct_sweep}}
\end{figure}

\begin{figure}
	\includegraphics[width=0.8\textwidth]{spectra_thrust_cthat.eps}
	\caption{Power spectral density (PSD) estimates of the row-averaged thrust force $f_T$ (\emph{a}) and thrust coefficient $\cthat$ (\emph{b}) as a function of frequency $f$ (bottom axis) and non-dimensional Strouhal number $St$ (top axis). \label{fig:spectra_thrust_cthat}}
\end{figure}

Figure~\ref{fig:spectra_thrust_cthat}a,b shows row-averaged power spectral densities of the thrust forces and thrust coefficients respectively. The figure shows that the variances of both the thrust coefficients and their resulting forces are highest in row 1. Further downstream, rows 2 to 11 have very similar spectral behavior, and row 12 shows significantly lower variability. The high-frequency slopes of around $-5$ observed both for $f_T$ and $\cthat$ indicate that force variability on short timescales is caused mainly by thrust coefficient variations, whereas the slower thrust force dynamics tend more to a $-5/3$ slope, suggesting that these are governed by the unsteadiness in the turbulence instead. Note that, even though the spectra for all rows except row 12 collapse at frequencies below $0.05$ Hz, the first-row spectrum shows a small peak at $f \approx 0.02 \dots 0.03$ Hz ($f D / U_\infty \approx 0.2 \dots 0.3$) as indicated by the purple arrow. It will be shown later in this paper that variations in the thrust coefficient around this frequency are directly related to increased power extraction. 

\subsection{Application of optimal thrust coefficients to subsets of turbine rows}\label{sec:application_subset}

In order to further study how the optimal controls increase overall wind-farm power, Figure~\ref{fig:multirow} shows power extraction resulting from applying a subset of the optimal controls to specific turbine rows only. Figure~\ref{fig:multirow}a depicts simulation results for which the  optimized controls are applied \emph{only to one specific row}, with the thrust coefficient in all other rows kept at the reference value of $\cthat = 2$. From the figure it can be seen that only for the controls of the first row (R1) this results in a significant power increase in rows 2 and 3. This indicates that the optimal controls, as generated by the optimization at the wind-farm level, react to the precise flow conditions caused by upstream control actions, and can hence only be applied independently for the first row, which has no upstream dependence by definition. 

Figure~\ref{fig:multirow}b shows results from simulations in which the controls are applied \emph{for all rows up to a certain row}, i.e. R1--R3 indicates the application of optimized controls generated by case C3t5 to rows 1, 2, and 3. An interesting observation from this figure is that , for any row $i$ except the last one, the power potential as observed in case C3t5 is almost fully recovered by only applying the optimal controls up to row $i-1$. This suggests that self-optimization is very limited: the optimal controls for a given turbine are designed to create favorable flow conditions in the downstream rows instead of increasing local power. Furthermore, although the discussion in the previous paragraph has shown that downstream controls are optimized with the upstream actions in mind, the converse is not true: upstream control actions do not require a specific downstream response in order to increase power in that downstream row. 

\begin{figure}
	\includegraphics[width=\textwidth]{multirow.eps}
	\caption{Normalized row-averaged power extraction for the reference case, optimal control case C3t5, and subset control cases up to optimization window 3. \emph{a)} Subset control cases with optimal controls applied \emph{only} in one specific row. \emph{b)} Subset control cases with optimal controls applied \emph{for all rows up to} specific row. \label{fig:multirow}}
\end{figure}

\subsection{Optimization of single active turbine rows}\label{sec:optimization_single}
The previous section has shown that, based on the full-farm optimization case, the first-row controls can be applied independently from other turbine controls, whereas this does not work for the downstream rows. To further quantify the potential for increasing wind-farm power in each row of turbines, the current section considers a set of additional optimal control cases in which \emph{only a single active row is optimized}, with all other rows remaining passive. Furthermore, by comparing the optimized controls of these cases with the full-farm optimization case C3t5, the degree of cooperation between turbines can be assessed. Note that the current single-row optimal control is not equivalent to greedy control: the optimizer still aims to increase aggregate farm power by taking into account wake interactions with downstream turbines. Furthermore, in contrast to the single-row control simulations from the previous section (i.e. in Figure~\ref{fig:multirow}a), the current optimizations will yield controls that are \emph{explicitly designed} to increase power given that all other rows are passive. To limit computational costs, the additional optimizations are only performed for a single time window. 

Figure~\ref{fig:single_row_opt} shows the relative increase in wind-farm power extraction for each of the twelve individually optimized control cases. The optimization is run until the continuous adjoint gradient accuracy prevents further progress in the optimization. Upon interpreting the actual values from the figure, it is important to note that the reported power gain covers the full optimization horizon $T$, and is hence affected by finite-horizon effects. Furthermore, the first window of an optimal control simulation, as considered here, contains an initial dead zone corresponding to the wake advection lag before upstream turbines start influencing their downstream neighbors. This tends to reduce gains compared to later time windows. Nevertheless, the relative order of the different cases still provides information that can be generalized to full optimal control studies with multiple windows and longer time horizons. 

The figure shows that the first row (R1) holds by far the most promise for optimizing wind-farm power. This is not surprising as R1 produces the most power of all rows, and typically leaves the deepest wakes, causing second-row turbines to perform  poorly in aligned wind-farm layouts (see, e.g., \citealp{porte2013numerical,nilsson2015large}; and \citealp{stevens2016effects}). At the other end of the spectrum, the last row (R12) is the least useful. The intermediate rows (R2--R11) lie closer together, with the general trend being that the potential is somewhat decreased with downstream distance into the wind farm, although this decrease is not monotonous. 

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{single_row_opt.eps}
	\caption{Increase in wind-farm power extraction for the first (and only) timewindow of the optimal control cases in which only a single row is optimized. \label{fig:single_row_opt}}
\end{figure}

Figure~\ref{fig:gains_singlerow} illustrates the row-wise relative power increase matrix for each of the single-row optimization cases. The figure indicates that, for each of the optimization cases, the largest power increase is observed in the first row downstream of the active turbine (i.e. R$_{\rm i+1}$), and that the influence on row R$_{\rm i+3}$ is limited. This is explained by the fact that the finite optimization horizon used in MM17 (i.e. $T = 240$ s) allows for more interactions with directly neighboring turbines than with those located further downstream. Furthermore, except for the optimal control case of the last row (R12), self-optimization is virtually non-existent: power gains are achieved by modifying the flow to yield more favorable conditions for downstream rows. 

\begin{figure}
	\centering
	\includegraphics[width=0.75\textwidth]{individual_gains.eps}
	\caption{Relative power increase matrix for downstream rows in the single-row optimization case for row R$_{\rm i}$, indicated in the horizontal axis. N/A indicates non-existing downstream rows. Finite-horizon effects are eliminated by only reporting power increase up until $t = T_A$ for the active row R$_i$. \label{fig:gains_singlerow}}
\end{figure}

\subsection{Modification of thrust coefficient signals}\label{sec:modified_thrust}
The observations from previous sections illustrate that, at least to some degree, the optimized thrust coefficients are tuned to local flow conditions. In the current section, the possibility of whether the coefficients contain traits that are independent of flow conditions is investigated. To this end, the optimized thrust coefficients are modified in such a way that correlations between them and specific flow events are eliminated. This is done in two independent test cases.

In the first case, the controls, which were specifically generated for selected turbines, are reassigned to other turbines by randomly swapping the control sets of different turbine columns. In doing so, each turbine will receive controls that were specifically designed for another turbine in the same row. To avoid erroneous conclusions based on coincidence, the column swap is performed in 2 random independent ways. Row-averaged power for these cases is shown in Figure~\ref{fig:scrambled}a. 

In the second case, controls remain assigned to their original turbines, but are shuffled in time by randomly swapping optimal controls generated for different control windows. In this way, the spectral thrust characteristics for timescales smaller that the control horizon $T_A = 120$ s remain unchanged, whereas the time synchronization of control actions to specific flow events is eliminated. Similar to the first case, this is done in 2 random ways, and Figure~\ref{fig:scrambled}b illustrates the row-averaged power for these cases.

The figure shows similar behavior for each of the modified control cases: only in the second row (R2), a consistent (though small) increase in power extraction can be observed. This suggests the presence of flow-invariant	features in the control signals of the first row. Note however that the full power gain in the second row is only partially attained, indicating that also the first turbine row reacts to the specific flow conditions.  

\begin{figure}
	\includegraphics[width=\textwidth]{scrambled.eps}
	\caption{Normalized row-averaged power extraction for the reference case, optimal control case C3t5, and modified control cases. \emph{a)} Modified control cases with controls swapped between wind-turbine columns. \emph{b)} Modified control cases with controls swapped randomly by time window. \label{fig:scrambled}}
\end{figure}

\subsection{Discussion}\label{sec:analysis_discussion}

The observations and experiments from previous sections have revealed information that increases the understanding the optimized thrust coefficients, and can be used as a starting point towards designing practical wind-farm controllers that do not require computationally prohibitive LES-based optimal control simulations. A first conclusion that can be drawn from the analysis above is that wind turbines can be classified into three distinct categories, based on their position within the farm: first-row turbines, last-row turbines, and intermediate turbines.

The most salient behavior can be found in the first-row turbines (R1). Firstly, Figure~\ref{fig:spectra_thrust_cthat} showed that these turbines exhibit the largest variability in thrust coefficients and resulting thrust forces. Second, Figure~\ref{fig:multirow}a has shown that the optimized thrust coefficients in R1 are the only ones that can be applied independently from the other rows, and Figure~\ref{fig:single_row_opt} illustrated that the first row holds the greatest potential for power optimization of all rows in the farm. Third, the first row is the only one that has been shown to retain part of its power increase after eliminating the correlation between the optimized thrust coefficients and the flow field in Figure~\ref{fig:scrambled}, suggesting a flow-invariant component in the optimized coefficients. Finally, it is worth remarking the observed peak around $fD/U_\infty \approx 0.2 \dots 0.3$ from Figure~\ref{fig:spectra_thrust_cthat}. It will be shown below that variations in the thrust coefficient are related to specific flow events in the wake of R1.

The characteristics of the last row turbines (R12) also stand out from the rest. This is mainly caused by the fact that, by definition, the last row has no downstream turbines for which it can generate more favorable flow conditions, causing them to operate greedily in an optimal control setting. This explains the relatively quiescent behavior of optimized thrust coefficients in Figure~\ref{fig:controls}, and the limited potential for power increase in Figure~\ref{fig:single_row_opt}. 

The remaining intermediate rows (R2--R11) have similar spectral thrust characteristics (Figure~\ref{fig:spectra_thrust_cthat}) and potential for power increase (Figure~\ref{fig:single_row_opt}), situated in between but clearly separated from first- and last-row turbines. Further, it is worth noting that the behavior and analysis of control actions in these turbines is most complex: not only do they influence downstream turbines, they in turn are dependent on controls of upstream turbines. 

A second conclusion is that, whether or not the wind-farm is controlled with the possibility of active response and cooperation between turbines, the resulting power and thrust characteristics are very similar. Firstly, both Figure~\ref{fig:multirow}b (full-farm optimization) and Figure~\ref{fig:gains_singlerow} (single-row optimization) suggest that self-optimization of turbines is negligible, and that power gains are mainly achieved by generating more favorable flow conditions for downstream turbines. Furthermore, the remarkable match between optimized thrust coefficients for full-farm and single-row optimal control cases from Figure~\ref{fig:control_C3t5_singlerow} indicates that, at least for the first row, upstream controls do not rely on active downstream response. Instead, Figure~\ref{fig:multirow}b shows that, for any row $i$, the full potential in power increase is virtually attained by applying controls only for the upstream turbines up until row $i-1$. Furthermore, Figure~\ref{fig:multirow}a illustrates that optimized thrust coefficients in downstream rows by themselves do not result in power increase without also applying optimized coefficients in their upstream neighbors. This indicates that controls are tuned to specific flow events. This also explains the discrepancies between full-farm and single-row optimized thrust coefficients for downstream rows in Figure~\ref{fig:control_C3t5_singlerow}. 
These observations strongly suggest that the optimized thrust coefficients are designed in a parabolic manner, i.e. with a unidirectional propagation of control information from the first row to the last, and very little upstream influence of downstream turbine actions.

With this in mind, the following section of this paper will focus on the first and most promising link of the control chain: the turbines situated in the first row of the wind farm.

\section{First-row turbine behavior}\label{sec:analysis_flow_vis}
As shown in the previous section, the behavior of turbines within the first upstream row stands out from the others. Firstly, they are not influenced by any dynamic actions of the upstream turbines which makes their behavior somewhat easier to study. Secondly, they are unwaked and hence subjected to completely different flow characteristics than their downstream counterparts leading to much larger power extraction in the first row than downstream. Third, it was shown that the first-row controls show some inherent characteristics that are not tuned to specific flow events, and hence hold promise for simple and universally applicable control strategies. Therefore, the current section further focuses on the analysis of the first row. 

First, a qualitative analysis of the instantaneous flow field is performed in Section~\ref{sec:opt_visualization}, resulting in the observation of vortex rings being shed from first-row turbines. Thereafter, this mechanism is mimicked by imposing sinusoidally varying thrust coefficients in these turbines in Section~\ref{sec:opt_sinus}, with the aim of increasing power through similar mechanisms as in the computationally expensive optimal control cases.

\subsection{Flow field visualization}\label{sec:opt_visualization}
Figure~\ref{fig:vorticity_windfarm} shows snapshots of the vorticity and velocity fields at t = 300 s for the reference case (left) and the optimal control case C3t5 (right). Figures~\ref{fig:vorticity_windfarm}a,b show isosurfaces of vorticity magnitude, colored by streamwise velocity $\widetilde{u}_x$. Figure~\ref{fig:vorticity_windfarm}a shows that, in the reference case, the first-row turbines shed relatively stable vortex sheets that demarcate the wake from the freestream flow. The sheets destabilize and break up as they are advected downstream, resulting in complex three-dimensional vortical structures. Furthermore, as also shown in Figure~\ref{fig:vorticity_windfarm}c, wake mixing is limited, and downstream turbines experience reduced velocities. In contrast, the optimized case shows coherent vortex rings being shed from the first-row turbine. As indicated by the black arrows in Figure~\ref{fig:vorticity_windfarm}b, the locations of the rings in the controlled case coincide with naturally occurring bulges in the vortex sheet of the reference case: the controlled turbines further destabilize the sheet by well-timed temporal variations in its thrust coefficient. Figure~\ref{fig:vorticity_windfarm}c shows that this results in smaller velocity deficits in the wake region. Note that, downstream of the second turbine, the vorticity field becomes much more complex and differences in the flow fields are less coherent. 

The observed shedding of ring vortices seems to occur at specific flow-synchronized times to exploit natural instabilities in the original vortex sheets. Therefore, the remainder of this paper will attempt to accomplish the same effect by simple sinusoidal thrust variations. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{vorticity.eps}
	\caption{Instantaneous snapshots at t = 300 s of portion of wind-farm flow field for the reference (left) and optimized (right) case. \emph{a,b) } Isosurface of vorticity magnitude, colored by streamwise velocity $\widetilde{u}_x$. Deep wake regions (with $\widetilde{u}_x < 4.5$ m s$^{-1}$) are rendered in black. Black arrows indicate the naturally occuring unstable bulges in the reference case, and accompanying vortex rings in the optimized case. \emph{c)} Contours of streamwise velocity $\widetilde{u}_x$. Coloring is in units of m s$^{-1}$. Wind turbines are represented as gray disks. \label{fig:vorticity_windfarm}}
\end{figure}


\subsection{Sinusoidal thrust variations}\label{sec:opt_sinus}
The aim of the current section is to mimic the quasi-periodic shedding of vortex rings by upstream turbines as observed above through the use of simple periodic variations in the thrust coefficient. Instead of optimizing a high-dimensional control signal that can evolve freely in time as in MM17, we impose a sinusoidal perturbation on the Betz-optimal coefficient $\cthat = 2$, parametrized by its amplitude $A$, and its frequency in the form of a non-dimensional Strouhal number $St = f D/ U_\infty$, with $f$ the dimensional frequency, $D$ the turbine diameter, and $U_\infty$ the unperturbed time-averaged upstream velocity:
\begin{equation}
\cthat(t) = 2 + A \sin \bigg(2\pi St \frac{t U_\infty}{D} \bigg).\label{eq:define_thrust}
\end{equation}

\subsubsection{Parameter sweep}
Instead of optimizing $A$ and $St$ using a similar gradient-based optimization setup as in MM17, we perform a parameter sweep to find optimal parameter combinations. The reason for this is twofold. On the one hand we would need a rather long optimization horizon $T$ to find a robust parameter combination that is independent of specific flow realizations. However, the chaotic nature of turbulent flow fields makes long-time optimization using adjoint LES practically infeasible to date (see, e.g. \citealp{wang2014least}). On the other hand the fact that we have only two parameters renders a parameter sweep computationally feasible. The sweep is performed for a reduced-size wind-farm LES, as illustrated in Figure~\ref{fig:sinus_setup}. The farm consists of $4 \times 4$ turbines in an aligned layout with $S = 6D$ in both streamwise and spanwise directions, geometrically equivalent to the optimally controlled wind farm in MM17. The simulation is performed on a domain of $4 \times 2.4 \times 1$ km$^3$ with a simulation grid of $192 \times 256 \times 144$ gridpoints. A wall roughness length $z_0 = 10^{-1}$ m is used. A set of wind-farm flow simulations is advanced in time by 30 minutes, during which the front row is controlled using a sinusoidally varying thrust coefficient $\cthat$, as defined in Equation \eqref{eq:define_thrust}. Within this set, the amplitude $A$ is varied between 0.5 and 2, with increments of 0.5. Furthermore, the Strouhal number $St$ is varied between 0.05 and 0.6, with increments of 0.05. In total, this leads to 48 LES cases within the set. 

\begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{setup_sinusoidal.eps}
	\caption{Reduced $4 \times 4$ wind-farm simulation setup for sinusoidal variation parameter study showing instantaneous contours of streamwise velocity $\widetilde{u}_x$. Coloring is in units of m s$^{-1}$. The dashed line indicates the start of the fringe region for imposition of unwaked inflow conditions. \label{fig:sinus_setup}}
\end{figure}

Figure~\ref{fig:sinus_baseline} illustrates the power extraction for all cases considered. Figure~\ref{fig:sinus_baseline}a illustrates the relative power gains over the reference case. From the figure it can be seen that there is a well-defined range of values for $A$ and $St$ for which wind-farm power can be increased substantially through upstream sinusoidal thrust variations, with a maximal power increase of $\approx$ 5\% at $(St^\star, A^\star) = (0.25, 1.5)$. For instance, a Strouhal number $St = 0.25$ corresponds here to a sine wave period of $\approx$ 50 s for a turbine with diameter $D = 100$ m and a freestream velocity $U_\infty = 8.5$ m s$^{-1}$. The resulting maximum thrust coefficient of 3.5 can, e.g., be attained by an NREL 5MW rotor with a 50\% increase in chord length (see \citealp{goit2015optimal}, Appendix A). Figure~\ref{fig:sinus_baseline}b illustrates normalized power extraction by row for the reference case, the best sinusoidal case, and the first four rows of the optimal control case C3t5 from MM17. The figure shows that the power gain in the sinusoidal cases originates mostly from the second row, and that power in the first row is decreased by approximately 5\%. In contrast, optimal control case C3t5, in which all rows are active, also increases power in rows 3 and 4, and reduces first-row power by only 1\%. 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{gains_turbulent_6D_6D_6D_wide_inphase2.eps}
	\caption{Power extraction of baseline sinusoidal thrust case ($S = 6D$, $z_0 = 10^{-1}$ m). \emph{a) } Relative gain in mean wind-farm power extraction over reference case as a function of sine amplitude $A$ and frequency $St$. \emph{b) } Row-averaged mean power extraction for the best sinusoidal case, the optimal control case C3t5 from MM17, and the reference case, normalized by first-row reference power.\label{fig:sinus_baseline} }
\end{figure}

Figure~\ref{fig:vorticity_parametersweep} illustrates instantaneous vorticity and axial velocities for a set of wind turbines of the aforementioned reference case (a), the best sinusoidal case with $(St, A) = (St^\star, A^\star)= (0.25, 1.5)$ (b), and a sinusoidal case which does not lead to increased power extraction with $(St, A) = (0.6, 2)$ (c). The figure illustrates that sinusoidal variations in the first-row thrust coefficient indeed cause periodic shedding of vortex rings. Figure~\ref{fig:vorticity_parametersweep}b shows that, at the optimal frequency, this leads to increased wake mixing, providing the second-row turbine with a higher incoming velocity. In contrast, Figure~\ref{fig:vorticity_parametersweep}c shows that, even though higher frequency thrust oscillations also result in periodic shedding of vortex rings, this does not automatically lead to more favorable flow conditions for downstream turbines. Therefore, it can be concluded that a correct timing and spacing of vortex rings is essential for increased wake mixing.
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{pumpcases2.eps}
	\caption{Snapshots of wind-farm flow fields at t = 1 800 s. \emph{Left: } Isocontours of vorticity, colored by streamwise velocity. \emph{Right: } Contours of streamwise velocity. \emph{a)} Reference. \emph{b)} Best sinusoidal case, with $(St , A) = (St^\star, A^\star) = (0.25, 1.5)$. \emph{c)} Sinusoidal case with $(St, A) = (0.6, 2)$ \label{fig:vorticity_parametersweep}  }
\end{figure}

In order to assess whether the same strategy can be used in the downstream turbines as well, Figure~\ref{fig:sinus_row2} illustrates the results from an identical parameter sweep as discussed above, except that here the second turbine row is controlled using a sinusoidal thrust coefficient. Figure~\ref{fig:sinus_row2}a indicates that sinusoidal actuation of the second row invariably leads to losses in wind-farm power. Figure ~\ref{fig:sinus_row2}b  shows that, for the optimal combination of parameters of  $(St, A) = (0.25, 1.5)$ as reported for first-row actuation above, the minor power increase in the third row does not compensate for additional losses in the second and fourth row. This shows that the proposed simple control strategy does not work when applied to waked turbines, and that more elaborate control strategies are required to harness the gains achieved by the optimal control simulation in the downstream regions of the farm. 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{gains_row22.eps}
	\caption{Power extraction of second-row sinusoidal thrust case . \emph{a) } Relative gain in mean wind-farm power extraction over reference case as a function of sine amplitude $A$ and frequency $St$. \emph{b) } Row-averaged mean power extraction for the sinusoidal case with the optimal parameters as for row 1 sinusoidal thrust, and the reference case, normalized by first-row reference power.\label{fig:sinus_row2} }
\end{figure}

It is interesting to note that, even though the current parameter sweep is performed using different initial and inlet conditions than those applied in MM17, the optimal frequency of sinusoidal variations in $\cthat$ at $St^\star = f D / U_\infty = 0.25$ corresponds to the location of the peak in the first-row thrust coefficient spectrum of C3t5 in Figure~\ref{fig:spectra_thrust_cthat}. In the following paragraphs, the robustness of the best parameter pair for first-row thrust variations, i.e. $(St, A) = (0.25, 1.5)$, is investigated with the aim of assessing the general applicability of this control strategy. To this end, similar parameter sweeps are performed for cases with varying turbine spacings and turbulence intensities.


\subsubsection{Robustness with respect to turbine spacing and turbulence intensity}

Figure~\ref{fig:sinus_spacing} shows the power extraction resulting from two parameter sweeps with streamwise turbine spacings of $5D$ and $7D$ respectively. Results are promising: for the given cases, $St^\star$ and $A^\star$  do not depend on streamwise turbine spacing. Furthermore, even in the $7D$ spacing case (Figure~\ref{fig:sinus_spacing}c-d), which naturally features lower overall power losses in downstream rows, power extraction in the second row can be significantly increased through sinusoidal variations in the first-row thrust coefficient. 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{gains_combined2.eps}
	\caption{Power extraction of sinusoidal thrust cases with varying streamwise spacing. \emph{Top} (\emph{a,b}): Decreased spacing at $S = 5D$. \emph{Bottom} (\emph{c,d}): Increased spacing at $S = 7D$.  \emph{Left} (\emph{a,c}): Relative gain in mean wind-farm power extraction over reference case as a function of sine amplitude $A$ and frequency $St$. \emph{Right} (\emph{b,d}): Row-averaged mean power extraction for the best sinusoidal case and the reference case, normalized by first-row reference power. \label{fig:sinus_spacing} }
\end{figure}

Figure~\ref{fig:sinus_roughness} depicts the power extraction results from a parameter sweep with the same wind-farm layout as in the baseline case, but with a tenfold increase in roughness length, i.e. $z_0 = 1$ m. This results in a turbulence intensity of approximately 16\%, compared to 10\% in the baseline case. Again, the best parameter combination of $(St^\star, A^\star) = (0.25, 1.5)$ remains unchanged. Further, even for this higher turbulence case, in which downstream losses are lower due to naturally better wake mixing, power is increased in the second row, leading to a relative gain in wind-farm power of around 2\%. 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{gains_turbulent_6D_6D_6D_wide_antiphase_z0_1m2.eps}
	\caption{Power extraction of sinusoidal thrust case with increased wall roughness $z_0 = 1$ m. \emph{a) } Relative gain in mean wind-farm power extraction over reference case as a function of sine amplitude $A$ and frequency $St$. \emph{b) } Row-averaged mean power extraction for the best sinusoidal case and the reference case, normalized by first-row reference power.\label{fig:sinus_roughness} }
\end{figure}

%\begin{figure}
%	\centering
%	\includegraphics[width=\textwidth]{pump.eps}
%	\caption{a = reference, b = row 1, c= row 2\label{fig:vorticity_pump}}
%\end{figure}

As evidenced above, periodic sinusoidal variations of first-row thrust coefficients substantially increase power extraction in the second row, resulting in a net gain in total power for the considered $4\times4$ wind farm. Moreover, different simulation sets indicate that, at least for the range considered here, the best values for Strouhal number and amplitude of these variations, i.e. $(St^\star, A^\star) = (0.25, 1.5)$, are robust with respect to turbine spacing and turbulence intensity. 

\subsubsection{Full-scale wind-farm test}
In the remainder of this section, the sinusoidal variation strategy will be tested in a full-scale wind farm, corresponding to the full $12 \times 6$ aligned wind farm of MM17. Simulations are performed for a reduced range of amplitudes and Strouhal numbers, corresponding to the most favorable region identified in the parameter sweeps above. In order to increase statistical convergence, the time horizon for each simulation is extended to a physical time of 10 hours. 

Figure~\ref{fig:sinus_fullscale} shows the power extraction of the full-scale test. Figure~\ref{fig:sinus_fullscale}a and~\ref{fig:sinus_fullscale}b show the relative power gains over the reference case for the full wind farm and the first four turbine rows respectively. A first observation is that the optimal pair $(St^\star, A^\star)$ differs for both measures, suggesting that the increased power in front rows leads to losses in the downstream rows. This is confirmed by the row-wise power shown in Figure~\ref{fig:sinus_fullscale}c: from the fifth row onwards, power is slightly reduced in the sinusoidal cases. This explains the negligible increase in total farm power observed in Figure~\ref{fig:sinus_fullscale}a. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{gains_fullscale.eps}
	\caption{Power extraction of full-scale sinusoidal thrust case ($S = 6D$, $z_0 = 10^{-1}$ m). \emph{a) } Relative gain in mean wind-farm power extraction over reference case as a function of sine amplitude $A$ and frequency $St$. \emph{b) } Relative gain in mean power extraction for the first four rows. \emph{c) } Row-averaged mean power extraction for the best sinusoidal case, the optimal control case C3t5 from MM17, and the reference case, normalized by first-row reference power.\label{fig:sinus_fullscale} }
\end{figure}

The top panel of Figure~\ref{fig:cross_section_sinus} shows cross sections of time-averaged axial velocities $\widetilde{U}_x$ at the rotor disk locations for the reference case. Further, the middle and bottom panel illustrate deviations from the reference velocity for the $(St^\star, A^\star)$ sinusoidal case and the optimal control case C3t5 respectively.  The figure shows that both controlled cases show similar characteristics at the second turbine row, with an increased axial velocity at the rotor disk, accompanied by decreased velocities above and below. Downstream, it can be seen that the passive turbines of the sinusoidal case fail to retain increased velocities at the rotor disks, instead resulting in slightly lower disk velocities starting from the fifth row. In contrast, case C3t5, in which all turbines are actively controlled, succeeds to attain similar cross section characteristics with higher rotor velocities in the downstream as well. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{frontviews_allc3t5.eps}
	\caption{Cross section of time-averaged axial velocity $\widetilde{U}_x$ at rotor locations in rows 1, 2, 3, 4, 5, and 12. \emph{Top: } Reference case. \emph{Middle: } Difference between best sinusoidal perturbation case (with $A = 1.5$, $St = 0.25$) and reference case. \emph{Bottom: } Difference between optimal control case C3t5 and reference case. Coloring is in units of m s$^{-1}$. \label{fig:cross_section_sinus}}
\end{figure}

As shown throughout the current section, a qualitative analysis of instantaneous flow features in the optimal induction control wind farm from MM17 has led to the identification of a sinusoidal thrust control strategy for first-row turbines, resulting in increased power extraction in the second row. In contrast to earlier work on steady axial induction control, for which power gains have often been marginal or non-existent (see, e.g. \citealp{annoni2016analysis}), the current analysis resulted in a robust axial induction control strategy with significant power gains, independent of specific local flow conditions. However, important comments should be made. First, sustained sinusoidal thrust variations with a large amplitude could contribute significantly to turbine fatigue loading. Hence, structural aspects should be taken into account upon evaluating the practical viability of the approach. Second, even though experiments have shown that, for practically relevant tip speed ratios, wind turbines shed vortices in a similar way as disk-like bluff bodies \citep{medici2006measurements}, the current behavior could still be an artifact of the relatively simple ADM used throughout this study. Further verification using higher fidelity wind turbine models, such as actuator line models, and wind-tunnel testing is hence necessary. 

\section{Intermediate-row turbine behavior}\label{sec:analysis_intermediate}
The current section discusses the intermediate rows. It was shown that, without active participation in these rows, upstream gains are lost in downstream rows, and only full optimal control succeeds in achieving significant gains in downstream rows as well (see Figures~\ref{fig:sinus_fullscale},~\ref{fig:cross_section_sinus}). It was already mentioned that the analysis and behavior of turbines within intermediate rows is more complex than in the first row: they aim to influence the flow to the benefit of downstream rows but are also dependent on the actions of upstream rows. The remainder of the current section aims to illustrate the additional difficulty for power increase in downstream rows, and speculates on possible future paths for the identification of simplified control strategies as found for the first row.

First, as shown in the top panels of Figure~\ref{fig:cross_section_sinus}, even in the uncontrolled case, the kinetic energy of the flow in the vicinity of the turbine rotor is depleted more and more in the downstream rows. This complicates control strategies for these rows as the opportunity for increased mixing with high energy flow is decreased. Furthermore, intermediate turbines are subjected to increased turbulence levels and more complex vorticity dynamics, as illustrated in Figure~\ref{fig:vorticity_windfarm}. This could explain why the sinusoidal thrust control for the first row did not lead to increase power when applied to the second row: whereas the first row produces increased mixing by destabilizing relatively stable vortex sheets into vortex rings, the second row is already continuously immersed in complex vorticity patterns for which this simple approach does not work. 
However, note that for instance R7 in Figure~\ref{fig:controls} also seems to show quasi-periodic sinusoidal variations in $\cthat$ at a time period of approximately 50~s. This could be an indication that, also for intermediate rows, vortex ring shedding could amount to part of the power increase observed in the optimal control simulations, albeit at specific moments in time, synchronized with the local flow conditions.

Second, it is important to note that the vortex ring shedding mechanism constitutes only part of the power increase caused by the first row. Figure~\ref{fig:multirow} illustrates that the first-row optimized thrust coefficient also results in a significant power increase in the third row, which is not observed using the sinusoidal thrust strategy. Furthermore, the analysis of the modified control cases in Figure~\ref{fig:scrambled} proves that also the first-row controls are partially synchronized with the flow. This shows that other mechanisms, dependent on specific flow events for increasing wind-farm power, are at play as well. Even though the application of regression algorithms in an attempt to link turbine actions to low-dimensional flow measurements (e.g. local velocity, shear and kinetic energy) has been unsuccessful thus far, similar analysis based upon more complex flow features (e.g. vorticity structures, high-speed turbulent streaks, or downdrafts) might be more promising. However, this requires further optimal control simulations over an extended time, as the total control time horizon of 30 minutes in the current dataset is insufficient for robust statistics in this kind of analysis. This is an important remaining challenge to be addressed in future research. 

%\section{Summary}\label{sec:analysis_summ}
\conclusions \label{sec:analysis_summ}
The current paper provided an analysis of the thrust coefficient control characteristics for the C3t5 optimal control case featured in \cite{munters2017optimal}. 

Analysis of the thrust coefficients and numerical experiments have shown a clear distinction between first-row turbines, last-row turbines, and intermediate turbines. Furthermore, observations strongly suggest that the optimization works in a unidirectional way: upstream turbines influence the flow field resulting in favorable conditions for their downstream neighbors, yet information on the possibility of active response and cooperation in the latter has no influence on upstream control actions. 

Qualitative analysis of instantaneous flow fields led to the observation of quasi-periodic shedding of vortex rings from first-row turbines in the optimal control case. This flow feature was succesfully mimicked using simple sinusoidal thrust actuation of the first row. The best parameter set for these sinusoidal variations proved robust to both wind-turbine spacing and turbulence intensity, with an amplitude $A^\star = 1.5$ and a non-dimensional frequency at $St^\star = 0.25$. Interestingly, this frequency corresponds to the peak at $St = 0.2 \dots 0.3$ observed in the first-row thrust coefficient spectra of the optimal control case. Although the first-row sinusoidal control led to a robust increase in total power for a reduced-size $4\times4$ wind farm, a full-scale test indicated that downstream turbine activity is required to obtain increased power at larger farm scales. It was also shown that the simple sinusoidal strategy does not lead to increased power extraction when applied to downstream intermediate turbines. Identifying the mechanisms for power increase in these turbines hence remains an important open research question. Finally, it is important to remark that all current simulations were performed using a standard non-rotating actuator disk model without the inclusion of mechanical turbine loading. Therefore, wind tunnel testing and/or simulations with more advanced turbine models (such as the actuator line model) including assessment of turbine loading are essential to evaluate the real-life applicability of the sinusoidal thrust strategy. 


\dataavailability{TEXT} %% use this section when having only data sets available

%\appendix
%\section{}    %% Appendix A
%\subsection{}     %% Appendix A1, A2, etc.
%\noappendix       %% use this to mark the end of the appendix section

\competinginterests{The authors declare no conflict of interest.} %% this section is mandatory even if you declare that no competing interests are present

\begin{acknowledgements}
The authors acknowledge funding by the European Research Council (grant no. 306471). The computational resources and services used in this work were provided by the VSC (Flemish Supercomputer Center), funded by the Research Foundation - Flanders (FWO) and the Flemish Government, department EWI.
\end{acknowledgements}




%% REFERENCES
%\begin{thebibliography}{}
%
%\bibitem[AUTHOR(YEAR)]{LABEL}
%REFERENCE 1
%
%\bibitem[AUTHOR(YEAR)]{LABEL}
%REFERENCE 2
%
%\end{thebibliography}


\bibliographystyle{copernicus}
\bibliography{bib_induction_energies}


%% LITERATURE CITATIONS
%%
%% command                        & example result
%% \citet{jones90}|               & Jones et al. (1990)
%% \citep{jones90}|               & (Jones et al., 1990)
%% \citep{jones90,jones93}|       & (Jones et al., 1990, 1993)
%% \citep[p.~32]{jones90}|        & (Jones et al., 1990, p.~32)
%% \citep[e.g.,][]{jones90}|      & (e.g., Jones et al., 1990)
%% \citep[e.g.,][p.~32]{jones90}| & (e.g., Jones et al., 1990, p.~32)
%% \citeauthor{jones90}|          & Jones et al.
%% \citeyear{jones90}|            & 1990

\end{document}
